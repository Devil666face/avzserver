package view

templ baseAuth(title string) {
	@Base(title) {
		<main
			class="form-signin m-auto h-100 d-flex align-items-center justify-content-center"
			id="auth_form"
		>
			{ children... }
		</main>
	}
}

templ formFields(fields ...templ.Component) {
	for _,f:=range fields {
		<div class="form-floating">
			@f
		</div>
	}
}

templ emailField(m Map) {
	<input
		type="email"
		name="email"
		autocapitalize="none"
		autocomplete="username"
		maxlength="150"
		class="form-control"
		value={ m.getUser().Email }
		placeholder
		required
		autofocus
	/>
	<label>
		@emoji("📧") {
			Email
		}
	</label>
}

templ passwordField() {
	<div class="form-floating">
		<input
			type="password"
			name="password"
			autocomplete="current-password"
			class="form-control"
			placeholder
			required
		/>
		<label>
			@emoji("🔒") {
				Пароль
			}
		</label>
	</div>
}

func authButtonClass() string {
	return "btn btn-outline-primary w-100 py-2 mt-2"
}

templ Login(v *View, m Map) {
	@baseAuth("Login") {
		@FloatingAlert(m)
		<div class="d-flex flex-column align-items-center">
			<div class="text-center">
				<h1 class="h3 mb-3 fw-normal text-danger">
					@emoji("🚫☣️") {
						Anti-virus bases
					}
				</h1>
				<h1 class="h3 mb-3 fw-normal text-success">
					@emoji("➡️") {
						Войти
					}
				</h1>
			</div>
			<form
				hx-post={ v.URL("login") }
				enctype="multipart/form-data"
				hx-swap="outerHTML"
				hx-target="#auth_form"
				hx-select="#auth_form"
			>
				@formFields(emailField(m),passwordField())
				<button
					class={ authButtonClass() }
					type="submit"
				>
					@emoji("➡️") {
						Войти
					}
				</button>
				<button
					class={ authButtonClass() }
					type="button"
					hx-get={ v.URL("register") }
					hx-swap="outerHTML"
					hx-target="#auth_form"
					hx-select="#auth_form"
				>
					@emoji("🆕") {
						Регистрация
					}
				</button>
			</form>
			@Token(v.CsrfToken())
		</div>
	}
}
